import{i as F,r as _,k as L,o as r,c as m,w as a,a as n,m as N,bl as j,as as z,u as i,s as Q,b as p,d as J,E as B,bu as W,bv as Z,e as q,f as M,t as H,g as P,h,j as U,_ as K,cZ as X,c_ as ee,p as te,q as f,c$ as le,d0 as ne,v as ae,d1 as oe,x as ie}from"./index.370711b9.js";import{E as Y,a as O,b as G,c as se,d as re,e as ue,f as de}from"./el-overlay.fe961f6c.js";import"./vue-json-viewer.e75741dc.js";const me=p("Search"),ce=p("Reset"),pe={emits:["searchEmit"],setup(A,{emit:$}){const S=F("$axios"),b=_([]),k=_(["Y","N"]),g=_(null),u=_({id:null,name:null,status:null,enabled:null}),c=()=>{g.value.resetFields()};function E(){$("searchEmit",J.trimObjectValue(u.value))}function o(){S.get("/case-definition/getCaseStepStatusEnums").then(D=>{b.value=D.data})}return L(()=>{o()}),(D,d)=>{const I=B,y=Y,w=W,V=Z,v=O,e=G;return r(),m(e,{ref_key:"searchFormRef",ref:g,model:u.value,inline:!0},{default:a(()=>[n(y,{label:"ID",prop:"id"},{default:a(()=>[n(I,{modelValue:u.value.id,"onUpdate:modelValue":d[0]||(d[0]=l=>u.value.id=l),clearable:""},null,8,["modelValue"])]),_:1}),n(y,{label:"NAME",prop:"name"},{default:a(()=>[n(I,{modelValue:u.value.name,"onUpdate:modelValue":d[1]||(d[1]=l=>u.value.name=l),clearable:""},null,8,["modelValue"])]),_:1}),n(y,{label:"STATUS",prop:"status"},{default:a(()=>[n(V,{modelValue:u.value.status,"onUpdate:modelValue":d[2]||(d[2]=l=>u.value.status=l),clearable:"",filterable:""},{default:a(()=>[(r(!0),N(z,null,j(b.value,l=>(r(),m(w,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(y,{label:"ENABLED",prop:"enabled"},{default:a(()=>[n(V,{modelValue:u.value.enabled,"onUpdate:modelValue":d[3]||(d[3]=l=>u.value.enabled=l),clearable:"",filterable:""},{default:a(()=>[(r(!0),N(z,null,j(k.value,l=>(r(),m(w,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(y,null,{default:a(()=>[n(v,{type:"primary",icon:i(Q),onClick:d[4]||(d[4]=l=>E())},{default:a(()=>[me]),_:1},8,["icon"]),n(v,{type:"primary",onClick:d[5]||(d[5]=l=>c())},{default:a(()=>[ce]),_:1})]),_:1})]),_:1},8,["model"])}}},fe={class:"dialog-footer"},_e=p("Cancel"),be=p("Reset"),ye=p("Confirm"),ve={props:{data:Object},emits:["closeDialogEmit","refreshEmit"],setup(A,{emit:$}){const S=A,b=q(),{activedProjectId:k}=M(b),g=F("$axios"),u=_("200px");_([]),_([]);const c=H(S,"data"),E=_(null),o=P({entity:{id:null,name:null,description:null,projectId:null}}),D=P({name:[{required:!0,message:"Please input name",trigger:"blur"},{min:1,max:50,message:"Length should be 1 to 50",trigger:"blur"}],description:[{required:!0}]}),d=()=>{E.value.validate((v,e)=>{v?o.entity.id?g.put("/case-definition",o.entity).then(l=>{w(),V()}):g.post("/case-definition",o.entity).then(l=>{w(),V()}):console.log("error submit!",e)})};function I(){c.value.id?g.get("/case-definition/"+c.value.id).then(v=>{o.entity=v.data,o.entity.projectId=k.value}):o.entity={projectId:k.value}}function y(){E.value.resetFields()}function w(){$("closeDialogEmit")}function V(){$("refreshEmit")}return(v,e)=>{const l=B,s=Y,C=G,x=O,R=se;return r(),m(R,{modelValue:i(c).visiable,"onUpdate:modelValue":e[6]||(e[6]=t=>i(c).visiable=t),onOpen:I,title:i(c).id?"Edit":"Add"},{footer:a(()=>[h("span",fe,[n(x,{onClick:e[3]||(e[3]=t=>w())},{default:a(()=>[_e]),_:1}),i(c).id?U("",!0):(r(),m(x,{key:0,type:"primary",onClick:e[4]||(e[4]=t=>y())},{default:a(()=>[be]),_:1})),n(x,{type:"primary",onClick:e[5]||(e[5]=t=>d())},{default:a(()=>[ye]),_:1})])]),default:a(()=>[n(C,{ref_key:"formRef",ref:E,model:i(o).entity,rules:i(D)},{default:a(()=>[i(c).id?(r(),m(s,{key:0,label:"ID",prop:"id","label-width":u.value},{default:a(()=>[n(l,{modelValue:i(o).entity.id,"onUpdate:modelValue":e[0]||(e[0]=t=>i(o).entity.id=t),disabled:"",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])):U("",!0),n(s,{label:"NAME",prop:"name","label-width":u.value},{default:a(()=>[n(l,{modelValue:i(o).entity.name,"onUpdate:modelValue":e[1]||(e[1]=t=>i(o).entity.name=t),clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),n(s,{label:"DESCRIPTION",prop:"description","label-width":u.value},{default:a(()=>[n(l,{modelValue:i(o).entity.description,"onUpdate:modelValue":e[2]||(e[2]=t=>i(o).entity.description=t),type:"textarea",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};const Ee={class:"flex",style:{margin:"10px 10px"}},Ce=p("\u6DFB\u52A0"),he={style:{display:"flex","align-items":"center"}},ge={style:{display:"flex","align-items":"center"}},we={setup(A){const $=q(),{activedProjectId:S}=M($),b=F("$axios"),k=X(),g=ee(),u=_(g.query.caseType);debugger;const c=_({visiable:!1,id:null}),E=_([]);function o(e){e=e||{},e.projectId=S.value,e.caseType=u.value,b.get("/case-definition/page",{params:e}).then(l=>{E.value=l.data.records})}function D(e){let l=e.enabled=="Y"?"N":"Y";b.post("/case-definition/changeEnabled/"+e.id+"?enabled="+l).then(s=>{e.enabled=l})}function d(e){k.push({path:"/quietly/step-definition",query:{caseId:e.id,name:e.name}})}function I(e){b.get("/case-definition/runCase/"+e.id).then(l=>{e.status="QUEUING"})}function y(e){c.value.id=e||null,v(!0)}function w(e){b.post("/case-definition/copy/"+e).then(l=>{o()})}function V(e,l){b.delete("/case-definition/"+l.id).then(s=>{E.value.splice(e,1)})}function v(e){c.value.visiable=e}return L(()=>{o()}),(e,l)=>{const s=O,C=re,x=ue,R=de;return r(),N("div",null,[n(pe,{onSearchEmit:o}),h("div",Ee,[n(s,{type:"primary",icon:i(te),onClick:l[0]||(l[0]=t=>y())},{default:a(()=>[Ce]),_:1},8,["icon"])]),n(R,{data:E.value,stripe:"","highlight-current-row":"",height:"calc(100vh - 60px - 40px - 150px)"},{default:a(()=>[n(C,{type:"expand"},{default:a(t=>[h("div",null,[h("p",null,"ID: "+f(t.row.id),1),h("p",null,"PROJECT_ID: "+f(t.row.projectId),1),h("p",null,"DESCRIPTION: "+f(t.row.description),1),h("p",null,"CREATE_TIME: "+f(t.row.createTime),1)])]),_:1}),n(C,{prop:"name",label:"NAME"}),n(C,{prop:"caseType",label:"CASE_TYPE",width:"120"}),n(C,{prop:"status",label:"STATUS",width:"130"},{default:a(t=>[h("div",he,[t.row.status=="SUCCESS"?(r(),m(s,{key:0,type:"success",round:"",size:"small"},{default:a(()=>[p(f(t.row.status),1)]),_:2},1024)):t.row.status=="FAILED"?(r(),m(s,{key:1,type:"danger",round:"",size:"small"},{default:a(()=>[p(f(t.row.status),1)]),_:2},1024)):t.row.status=="QUEUING"?(r(),m(s,{key:2,type:"warning",round:"",size:"small"},{default:a(()=>[p(f(t.row.status),1)]),_:2},1024)):t.row.status=="CANCELED"?(r(),m(s,{key:3,type:"warning",round:"",size:"small"},{default:a(()=>[p(f(t.row.status),1)]),_:2},1024)):(r(),m(s,{key:4,type:"primary",round:"",size:"small"},{default:a(()=>[p(f(t.row.status),1)]),_:2},1024))])]),_:1}),n(C,{prop:"enabled",label:"ENABLED",width:"130"},{default:a(t=>[h("div",ge,[n(x,{title:"Are you sure to enable or disable this one?",onConfirm:T=>D(t.row)},{reference:a(()=>[t.row.enabled=="Y"?(r(),m(s,{key:0,type:"success",round:"",size:"small",title:"switch to enable or disable"},{default:a(()=>[p(f(t.row.enabled),1)]),_:2},1024)):(r(),m(s,{key:1,type:"danger",round:"",size:"small",title:"Set as default"},{default:a(()=>[p(f(t.row.enabled),1)]),_:2},1024))]),_:2},1032,["onConfirm"])])]),_:1}),n(C,{prop:"updateTime",label:"UPDATE_TIME",width:"180"}),n(C,{fixed:"right",label:"Operations",width:"240"},{default:a(t=>[n(s,{type:"primary",icon:i(le),circle:"",size:"small",title:"Step setting",onClick:T=>d(t.row)},null,8,["icon","onClick"]),t.row.enabled=="Y"&&(t.row.status=="CREATED"||t.row.status=="SUCCESS"||t.row.status=="FAILED"||t.row.status=="CANCELED")?(r(),m(x,{key:0,title:"Are you sure to run this test case?",onConfirm:T=>I(t.row)},{reference:a(()=>[n(s,{type:"primary",icon:i(ne),circle:"",size:"small",title:"Run Case"},null,8,["icon"])]),_:2},1032,["onConfirm"])):U("",!0),n(s,{type:"primary",icon:i(ae),circle:"",size:"small",title:"Edit",onClick:T=>y(t.row.id)},null,8,["icon","onClick"]),n(x,{title:"Are you sure to copy from this?",onConfirm:T=>w(t.row.id)},{reference:a(()=>[n(s,{type:"primary",icon:i(oe),circle:"",size:"small",title:"Copy"},null,8,["icon"])]),_:2},1032,["onConfirm"]),n(x,{title:"Are you sure to delete this?",onConfirm:T=>V(t.$index,t.row)},{reference:a(()=>[n(s,{type:"danger",icon:i(ie),circle:"",size:"small",title:"Delete"},null,8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),n(ve,{data:c.value,onCloseDialogEmit:l[1]||(l[1]=t=>v(!1)),onRefreshEmit:l[2]||(l[2]=t=>o())},null,8,["data"])])}}};var ke=K(we,[["__scopeId","data-v-8b37f45a"]]);export{ke as default};
